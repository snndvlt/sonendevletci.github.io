<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Blog</title>

<style>
/* GENEL */
body{
  font-family: Arial, sans-serif;
  margin:0;
  background:#f4f4f4;
}

/* HEADER */
header{
  background:#222;
  color:#fff;
  padding:15px 30px;
  display:flex;
  justify-content:center;
  align-items:center;
  position:relative;
}
header nav a{
  color:#fff;
  text-decoration:none;
  margin:0 20px;
  font-size:17px;
}
header nav a:hover{
  text-decoration:underline;
}

/* ADMIN */
.admin-area{
  position:absolute;
  right:20px;
}
.admin-area button{
  background:none;
  border:none;
  color:#fff;
  cursor:pointer;
  font-size:15px;
}

/* SAYFA */
.container{
  max-width:900px;
  margin:auto;
  padding:40px 20px;
}

h2{
  text-align:center;
  margin-bottom:35px;
}

/* MAKALE LİSTESİ */
.posts{
  display:flex;
  flex-direction:column;
  gap:35px;
}

/* MAKALE GÖRÜNÜMÜ */
.post-item{
  background:#fff;
  padding:30px 35px;
  border-radius:10px;
  box-shadow:0 2px 10px rgba(0,0,0,.08);
}

.post-item h3{
  margin:0 0 10px;
  font-size:26px;
  text-align:center;
}

.post-item .date{
  text-align:center;
  font-size:13px;
  color:#777;
  margin-bottom:18px;
}

.post-item .preview{
  font-size:16px;
  line-height:1.7;
  color:#444;
  margin-bottom:18px;
}

/* DEVAMINI OKU */
.read-more{
  display:inline-block;
  font-weight:bold;
  color:#2563eb;
  text-decoration:none;
}

.read-more:hover{
  text-decoration:underline;
}

/* MOBİL */
@media (max-width:768px){
  body{
    font-size:18px;
  }

  .post-item{
    padding:22px;
  }

  .post-item h3{
    font-size:22px;
  }

  .post-item .preview{
    font-size:17px;
  }
}
</style>
</head>

<body>

<header>
  <nav>
    <a href="index.html">Ana Sayfa</a>
    <a href="posts.html">Yazılar</a>
  </nav>

  <div class="admin-area">
    <button id="adminBtn" style="display:none;">Yönetici</button>
    <button id="logoutBtn" style="display:none;">Çıkış</button>
  </div>
</header>

<div class="container">
  <h2>Son Yazılar</h2>
  <div class="posts" id="latestPosts"></div>
</div>

<script>
const state = JSON.parse(localStorage.getItem('blog_state') || '{"posts":[]}');
const isAdmin = localStorage.getItem('admin') === '1';

/* ADMIN BUTONLARI */
if(isAdmin){
  document.getElementById('adminBtn').style.display = 'inline';
  document.getElementById('logoutBtn').style.display = 'inline';
}

document.getElementById('adminBtn').onclick = ()=>{
  window.location.href = 'posts.html';
};

document.getElementById('logoutBtn').onclick = ()=>{
  localStorage.removeItem('admin');
  alert('Çıkış yapıldı');
  location.reload();
};

/* SON 3 YAZI */
function renderLatest(){
  if(!state.posts) return;

  const container = document.getElementById('latestPosts');

  state.posts
    .filter(p => p.published)
    .sort((a,b)=> new Date(b.date) - new Date(a.date))
    .slice(0,3)
    .forEach(p=>{
      const article = document.createElement('article');
      article.className = 'post-item';

      article.innerHTML = `
        <h3>${p.title}</h3>
        <div class="date">${new Date(p.date).toLocaleDateString()}</div>
        <div class="preview">
          ${stripHtml(p.body).slice(0,220)}...
        </div>
        <a class="read-more" href="post.html?id=${p.id}">
          Devamını oku →
        </a>
      `;

      container.appendChild(article);
    });
}

/* HTML TEMİZLE (ÖNİZLEME) */
function stripHtml(html){
  const div = document.createElement('div');
  div.innerHTML = html;
  return div.textContent || '';
}

renderLatest();
</script>

</body>
</html>
